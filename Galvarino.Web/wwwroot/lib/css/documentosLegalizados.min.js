window._ingresados=[];const metodos={disparo:function(){var i=$("#folio-shot").val().substring(0,3),t;const n={codigoTipoDocumento:i,folioCredito:$("#folio-shot").val().substring(3,15),rutAfiliado:$("#folio-shot").val().substring(15,16),montoCredito:$("#folio-shot").val().substring(16,17),completado:!1,documentos:[i],obtenido:{},pistoleado:[]};t=_ingresados.findIndex(function(t){return t.folioCredito==n.folioCredito});t>-1&&typeof _ingresados[t]!="undefined"&&_ingresados[t].documentos.indexOf(i)>-1?$.niftyNoty({type:"danger",container:"floating",title:"Suceso Erroneo",message:"Error al Pistolear",closeBtn:!0,timer:5e3}):$.ajax({type:"GET",url:`/api/wf/v1/obtener-expediente/${n.folioCredito}`}).done(function(t){n.obtenido=t;let i=_ingresados.findIndex(function(t){return t.folioCredito==n.folioCredito});i>-1&&typeof _ingresados[i]!="undefined"&&n.folioCredito===_ingresados[i].folioCredito?_ingresados[i].documentos.indexOf(n.codigoTipoDocumento)<0&&_ingresados[i].documentos.push(n.codigoTipoDocumento):n.obtenido.id>0&&_ingresados.push(n);metodos.render()}).fail(function(){$.niftyNoty({type:"danger",container:"floating",title:"Suceso Erroneo",message:"Error al Pistolear:  "+$("#folio-shot").val()+"<br/><small>Puede que el documento este duplicado o no disponible para esta nómina<\/small>",closeBtn:!0,timer:5e3})});$("#folio-shot").val("")},render:function(){$(".contenedor-folios").html("");$.each(_ingresados,function(n,t){let i=``;$.each(t.obtenido.documentos,function(n,r){let u=t.documentos.indexOf(r.codificacion)>-1?"glyphicon-ok":"glyphicon-remove";i+=`<li><a href="#">${enumTipoDocumentos[r.tipoDocumento]} <i class="glyphicon ${u}" /></a></li>`});let r=t.obtenido.documentos.length===t.documentos.length?"btn-success":"btn-warning",u=`<div class="btn-group dropdown mar-rgt">
                <button class="btn ${r} dropdown-toggle dropdown-toggle-icon" data-toggle="dropdown" type="button" aria-expanded="false">
                    ${t.folioCredito} <i class="dropdown-caret"></i>
                </button>
                <ul class="dropdown-menu" style="">
                    ${i}
                </ul>
            </div>`;$(".contenedor-folios").append(u)})},avanzarWf:function(){let n=!1,t=_ingresados.map(function(t){return(n=t.documentos.length<t.obtenido.documentos.length,n)?!1:{folioCredito:t.folioCredito}});if(n)return $.niftyNoty({type:"danger",container:"floating",title:"Validación de Negocio!",message:"Ups. Debes tener todos los documentos pistoleados para poder procesar.",closeBtn:!0,timer:5e3}),!1;if(t.length==0)return $.niftyNoty({type:"danger",container:"floating",title:"Validación de Negocio!",message:"Ups. Debes agregar Expedientes para poder procesar.",closeBtn:!0,timer:5e3}),!1;$.ajax({type:"POST",url:`/api/wf/v1/ingreso-expedientes-legalizados`,data:JSON.stringify(t),contentType:"application/json; charset=utf-8"}).done(function(){$.niftyNoty({type:"success",container:"floating",title:"Ingreso de Expedientes ya Legalizados",message:"Los expedientes fueron marcados con exito. <br/><small>Ahora los puedes enviar en la nomina para Of. de Partes.<\/small>",closeBtn:!0,timer:3e3,onHidden:function(){location.href="/wf/v1/mis-solicitudes"}})}).fail(function(){$.niftyNoty({type:"warning",container:"floating",title:"Ingreso de Expedientes ya Legalizados",message:"Tarea No Finalizada, contacte a Soporte!",closeBtn:!0,timer:5e3})})}};$(function(){$("#form-pistoleo-detalle").on("submit",function(n){n.preventDefault();metodos.disparo()});$("#btn-generar-generico").on("click",function(){metodos.avanzarWf()})});
//# sourceMappingURL=documentosLegalizados.min.js.map